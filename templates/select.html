{% extends 'base.html' %}

{% block content %}
<div class="d-flex flex-column align-items-center justify-content-center min-vh-100 kitchen-bg text-center">
    <h2 class="mb-5" style="color: #5D4037;">Step 2: Choose Your Flavor</h2>

    <div class="row w-100 justify-content-center">
        <!-- Clear Soup (Divergent) -->
        <div class="col-md-4 mb-4">
            <div class="card shadow border-0 rounded-4 p-4 flavor-card" onclick="selectFlavor('divergent')" style="cursor: pointer; background: #E1F5FE; transition: transform 0.2s;">
                <div class="rounded-circle bg-white shadow mx-auto mb-3 d-flex align-items-center justify-content-center" style="width: 100px; height: 100px; font-size: 50px;">
                    üç≤
                </div>
                <h4 class="fw-bold" style="color: #0288D1;">Clear Soup</h4>
                <p class="text-muted">Divergent Thinking<br>(Knowledge Graph)</p>
            </div>
        </div>

        <!-- Red Oil (Convergent) -->
        <div class="col-md-4 mb-4">
            <div class="card shadow border-0 rounded-4 p-4 flavor-card" onclick="selectFlavor('convergent')" style="cursor: pointer; background: #FFEBEE; transition: transform 0.2s;">
                <div class="rounded-circle bg-white shadow mx-auto mb-3 d-flex align-items-center justify-content-center" style="width: 100px; height: 100px; font-size: 50px;">
                    ü•ò
                </div>
                <h4 class="fw-bold" style="color: #D32F2F;">Red Oil</h4>
                <p class="text-muted">Convergent Thinking<br>(Logic Tree)</p>
            </div>
        </div>
    </div>
    
    <!-- Piggy -->
    <div class="mt-5 text-center">
        <div class="piggy-face bg-white rounded-circle shadow d-inline-flex align-items-center justify-content-center border border-2 border-warning" style="width: 80px; height: 80px; font-size: 40px;">
            üê∑
        </div>
        <p class="mt-2 fst-italic text-muted">"Pick a base for your learning hotpot!"</p>
    </div>
</div>

<style>
    .flavor-card:hover {
        transform: scale(1.05);
    }
</style>

<script>
    async function selectFlavor(type) {
        // Animation
        document.querySelectorAll('.flavor-card').forEach(c => c.style.opacity = '0.5');
        
        try {
            const res = await fetch('/api/set_thinking_type/', {
                method: 'POST',
                body: JSON.stringify({thinking_type: type}),
                headers: {'Content-Type': 'application/json'}
            });
            const result = await res.json();
            if (result.status === 'success') {
                // Piggy shout (Optional UI feedback)
                // alert(type === 'divergent' ? "Fresh & Clear!" : "Spicy & Logical!");
                window.location.href = '/start/';
            } else {
                alert("Error: " + result.message);
                document.querySelectorAll('.flavor-card').forEach(c => c.style.opacity = '1');
            }
        } catch (err) {
            console.error(err);
            alert("Network Error");
        }
    }
</script>
{% endblock %}
